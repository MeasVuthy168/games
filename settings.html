<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Setting | Khmer Chess</title>

  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0d2d5c" />
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png" />
  <script src="js/pwa.js" defer></script>

  <link rel="stylesheet" href="styles.css" />
  <script type="module" src="js/settings.js"></script>

  <!-- Page-specific polish -->
  <style>
    /* Profile bar layout and circular avatar */
    .profile-bar{
      display:flex; align-items:center; gap:14px;
      padding:12px 14px;
    }
    .profile-bar .profile-meta{ display:flex; flex-direction:column; gap:4px }
    .profile-bar .profile-name{ font-weight:800; font-size:1.05rem }
    .profile-bar .profile-sub{ opacity:.75; font-weight:600 }

    .avatar{
      width:92px; height:92px;
      border-radius:50%;
      object-fit:cover; object-position:center;
      border:3px solid rgba(13,45,92,.12);
      box-shadow:0 6px 16px rgba(0,0,0,.08);
      background:#fff;
    }

    /* Modal small tweaks */
    .modal-card{ max-width:520px }
    .about-row{ display:flex; gap:8px; align-items:center; padding:6px 0 }
    .about-row strong{ min-width:130px }
    .about-row a{ color:#2b4f9e; text-decoration:none }
    .about-row a:hover{ text-decoration:underline }
  </style>
</head>
<body>
  <div class="shell">
    <!-- (top bar removed) -->

    <main class="page settings-page">
      <!-- Profile -->
      <section class="profile-bar card card-full">
        <img id="profImg" class="avatar" src="assets/icons/icon-192.png" alt="user" />
        <div class="profile-meta">
          <div id="profName" class="profile-name">Guest</div>
          <div class="profile-sub">admin</div>
        </div>
      </section>

      <div class="card-list">
        <div class="card card-full disabled">
          <div class="card-left"><div class="card-title">Personal Info</div><div class="card-sub">coming soon</div></div>
          <div class="card-right">›</div>
        </div>

        <div class="card card-full disabled">
          <div class="card-left"><div class="card-title">Notifications</div><div class="card-sub">coming soon</div></div>
          <div class="card-right">›</div>
        </div>

        <div class="card card-full">
          <div class="card-left">
            <div class="card-title">Sound</div>
            <div class="card-sub">Turn game sounds on/off</div>
          </div>
          <div class="card-right">
            <label class="switch">
              <input type="checkbox" id="soundToggle" />
              <span class="slider"></span>
            </label>
            <button class="pill" id="btnTestBeep">Test</button>
          </div>
        </div>

        <details class="card card-full exp">
          <summary>
            <div class="card-left"><div class="card-title">Timer</div><div class="card-sub">Default time control</div></div>
            <div class="card-right caret">›</div>
          </summary>
          <div class="card-body">
            <label class="field"><span>Minutes per side</span><input type="number" id="minutesInput" min="1" max="180" step="1" /></label>
            <label class="field"><span>Increment (seconds)</span><input type="number" id="incInput" min="0" max="60" step="1" /></label>
            <div class="row-inline"><button class="primary" id="btnSaveTimer">Save</button><button class="secondary" id="btnResetTimer">Defaults</button></div>
          </div>
        </details>

        <details class="card card-full exp">
          <summary>
            <div class="card-left"><div class="card-title">Theme</div><div class="card-sub">Choose app appearance</div></div>
            <div class="card-right caret">›</div>
          </summary>
          <div class="card-body">
            <label class="radio"><input type="radio" name="theme" value="auto" checked /> <span>Auto</span></label>
            <label class="radio"><input type="radio" name="theme" value="light" /> <span>Light</span></label>
            <label class="radio"><input type="radio" name="theme" value="dark" /> <span>Dark</span></label>
          </div>
        </details>

        <div class="card card-full">
          <div class="card-left"><div class="card-title">Move Hints</div><div class="card-sub">Show green dots for legal moves</div></div>
          <div class="card-right">
            <label class="switch"><input type="checkbox" id="hintsToggle" /><span class="slider"></span></label>
          </div>
        </div>

        <button class="card card-full clickable" id="btnAbout">
          <div class="card-left"><div class="card-title">About App</div><div class="card-sub">Version & credits</div></div>
          <div class="card-right">›</div>
        </button>
      </div>
    </main>

    <!-- About modal -->
    <div class="modal" id="aboutModal" aria-hidden="true">
      <div class="modal-backdrop" data-close></div>
      <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="aboutTitle">
        <header class="modal-header">
          <h3 id="aboutTitle">About App</h3>
          <button class="icon-btn" data-close>✖</button>
        </header>
        <div class="modal-body">
          <div class="about-row"><strong>Version:</strong> <span id="aboutVersion">—</span></div>
          <div class="about-row"><strong>Released Date:</strong> <span id="aboutReleased">—</span></div>
          <div class="about-row"><strong>Developer:</strong> Meas Vuthy</div>
          <div class="about-row"><strong>Email:</strong> <a href="mailto:measvuthy21@gmail.com">measvuthy21@gmail.com</a></div>
        </div>
      </div>
    </div>

    <!-- Auto-hide bottom nav -->
    <footer id="appTabbar" class="home-nav">
      <a class="nav-item" href="index.html">
        <img class="ni-img" src="assets/ui/nav-home.png" alt=""><span>Home</span>
      </a>
      <a class="nav-item" href="friends.html">
        <img class="ni-img" src="assets/ui/nav-friends.png" alt=""><span>Friend</span>
      </a>
      <a class="nav-item" href="play.html">
        <img class="ni-img" src="assets/ui/nav-play.png" alt=""><span>Play</span>
      </a>
      <a class="nav-item active" href="settings.html" aria-current="page">
        <img class="ni-img" src="assets/ui/nav-settings.png" alt=""><span>Setting</span>
      </a>
      <a class="nav-item" href="notifications.html">
        <img class="ni-img" src="assets/ui/nav-bell.png" alt=""><span>Notification</span>
      </a>
    </footer>
    <div id="bottomSpacer" aria-hidden="true"></div>
  </div>

  <script>
    (function(){
      const bar = document.getElementById('appTabbar');
      const spacer = document.getElementById('bottomSpacer');
      if(!bar || !spacer) return;

      function setSpacer(){ spacer.style.height = bar.offsetHeight + 'px'; }
      if (document.readyState === 'complete') setSpacer(); else window.addEventListener('load', setSpacer);
      window.addEventListener('resize', setSpacer);

      const page = (location.pathname.split('/').pop() || 'settings.html');
      for(const a of bar.querySelectorAll('a')){
        if(a.getAttribute('href') === page) a.classList.add('active');
      }

      let last = window.scrollY;
      window.addEventListener('scroll', () => {
        const y = window.scrollY;
        bar.style.transform = (y > last) ? 'translateY(110%)' : 'translateY(0)';
        last = y;
      }, { passive:true });
    })();
  </script>
</body>
</html>
