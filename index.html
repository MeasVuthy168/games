<!doctype html>
<html lang="km">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>á¢á»á€á…ááŸ’ášá„áŸ’á‚ (Khmer Chess)</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#0d2d5c" />
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png" />
  <script src="js/pwa.js" defer></script>

  <link rel="stylesheet" href="styles.css" />
  <style>
    /* small helpers for the home tiles */
    .menu-grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:1rem;
      padding:1rem;
    }
    .menu-card{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      background:#fff;
      padding:1rem;
      border-radius:1rem;
      text-decoration:none;
      color:#0d2d5c;
      box-shadow:0 4px 12px rgba(0,0,0,.08);
      font-weight:700;
    }
    .menu-card:active{transform:scale(.98)}
    .card-emoji{font-size:2.2rem;margin-bottom:.4rem}
    .avatar{width:36px;height:36px;border-radius:50%;object-fit:cover}
  </style>
</head>
<body>
  <div class="app home-app">
    <!-- Top bar -->
    <header class="topbar">
      <h1>á¢á»á€á…ááŸ’ášá„áŸ’á‚ (Khmer Chess)</h1>
      <div class="spacer"></div>
      <a href="settings.html" class="avatar-link" title="Setting">
        <img src="assets/icons/icon-192.png" alt="user" class="avatar" />
      </a>
    </header>

    <!-- Main -->
    <main class="home-main">
      <!-- Install PWA button -->
      <button id="installBtn" class="install-btn" style="display:none">
        ğŸ“² á’áŸ’áœá¾á€á¶ášááŸ†á¡á¾á„á€á˜áŸ’á˜áœá·á’á¸ (Install App)
      </button>

      <!-- Game Mode Menu -->
      <div class="menu-grid">
        <a class="menu-card" href="play.html?mode=ai">
          <div class="card-emoji">ğŸ¤–</div>
          <span>á›áŸá„á‡á¶á˜á½á™ AI</span>
        </a>
        <a class="menu-card" href="play.html?mode=friend">
          <div class="card-emoji">ğŸ‘¥</div>
          <span>á›áŸá„á‡á¶á˜á½á™á˜á·ááŸ’á</span>
        </a>
      </div>
    </main>

    <!-- âœ… Auto-hide bottom navigation -->
    <footer id="appTabbar" class="bottom-bar">
      <a class="nav-item active" href="index.html" aria-current="page">
        <img class="ni-img" src="assets/ui/nav-home.png" alt=""><span>Home</span>
      </a>
      <a class="nav-item" href="friends.html">
        <img class="ni-img" src="assets/ui/nav-friends.png" alt=""><span>Friend</span>
      </a>
      <a class="nav-item" href="play.html">
        <img class="ni-img" src="assets/ui/nav-play.png" alt=""><span>Play</span>
      </a>
      <a class="nav-item" href="settings.html">
        <img class="ni-img" src="assets/ui/nav-settings.png" alt=""><span>Setting</span>
      </a>
      <a class="nav-item" href="notifications.html">
        <img class="ni-img" src="assets/ui/nav-bell.png" alt=""><span>Notification</span>
      </a>
    </footer>

    <!-- Spacer so content never sits under the bar -->
    <div id="bottomSpacer" aria-hidden="true"></div>
  </div>

  <!-- Auto-hide + highlight active tab -->
  <script>
    (function(){
      const bar = document.getElementById('appTabbar');
      const spacer = document.getElementById('bottomSpacer');
      if(!bar || !spacer) return;

      function setSpacer(){ spacer.style.height = bar.offsetHeight + 'px'; }
      if(document.readyState === 'complete') setSpacer();
      else window.addEventListener('load', setSpacer);
      window.addEventListener('resize', setSpacer);

      // Highlight current tab
      const page = (location.pathname.split('/').pop() || 'index.html');
      for(const a of bar.querySelectorAll('a')){
        if(a.getAttribute('href') === page) a.classList.add('active');
      }

      // Auto hide on scroll (like Play page)
      let lastY = window.scrollY;
      window.addEventListener('scroll', () => {
        const y = window.scrollY;
        const down = y > lastY;
        bar.style.transform = down ? 'translateY(110%)' : 'translateY(0)';
        lastY = y;
      }, {passive:true});
    })();
  </script>
</body>
</html>
